# search_for-TV_series_intros
Нейронная сеть для нахождения заставок в фильмах.

1. Общий подход
   
   Анализируется только первая половина фильма - будем считать, что во второй половине заставки не встречаются либо это происходит крайне редко. Выполняется бинарная классификация каждой секунды фильма на 2 класса: заставка(1) и не заставка(0). Файл, содержащий фильм, разбивается на 2 составляющие: кадры(изображения в формате RGB) и звук.
   
   В звуковой составляющей в начале добавляются 5 секунд пустого звука для корректной работы алгоритма. Для анализа звук представляется в виде mel-спектрограммы.
   
   Для каждой секунды фильма будем рассматривать текущий кадр (изображение) и звуковую дорожку длиной 10 секунд с центром в текущей секунде.
   
   Для классификации текущей секунды используется архитектура на основе LSTM. В качестве эмбеддингов для LSTM используется конкатенация эмбеддингов размерности 500 кадра и звуковой дорожки. Итоговая размерность входного эмбеддинга - 1000. Размерность эмбеддингов скрытых слоёв - 300.
   
   Функция потерь - суммарная бнарная кросс-энтропия на всех секундах.
   
   Оптимизатор - Adam/SGD/LBFGS.
   
   Метрика качества: Q = A/B, где A - число правильно распознанных секунд, B - общее число секунд.
   
   После работы нейронных сетей каждая секунда будет классифицирована - подавляющая часть правильно, а малая часть неправильно. Из полученного интервала классифицированных точек нужно собрать непрерывные интервалы точек, входящих в заставку, и выбрать из них подходящий интервал. Для этого создадим одномерное пространство точек, распознанных, как заставки. Кластеризуем его с помощью DBSCAN (оптимальные гиперпараметры eps и minPts подбираются после обучения нейронных сетей) и со стандартной евклидовой метрикой - в данном случае она будет представлять собой количество секунд между точками. Из всех кластеров выберем тот, который будет включать больше всего точек - он и будет соответствовать заставке. В качестве ответа программа возвращает крайнюю левую точку в этом кластере - начало заставки, и крайнюю правую - конец заставки. Сложность алгоритма DBSCAN: O(n^2), где n - число объектов в пространстве. Так как заставки в поставленной задаче короткие, алгоритм будет работать быстро.
3. Нейронные сети
   2.1. EmbeddingAudio
        Принимает на вход размерность звуковой дорожки в формате mel-спектрограммы. Представляет собой свёрточную нейронную сеть с ядром размерности (1, 3). Превращает звуковую дорожку в эмбеддинг размерности 500.
   2.2. EmbeddingImage
        Принимает на вход размерность изображения. Представляет собой свёрточную нейронную сеть с ядром размерности (3, 3). Превращает изображение в эмбеддинг размерности 500.
   2.3. LSTM
        Нейронная сеть для посекундной классификации.
4. Преимущества
   - высокая скорость работы
   - низкие требования к вычислительным ресурсам и оперативной памяти при обучении и работе
   - учёт звукового контекста для каждой секунды
   - Для каждой секунды учитывается информация о предыдущей части фильма
5. Недостатки
   - Добавление искусственного звука в начале фильма может негативно повлиять на классификацию первых секунд видео
   - Отсутствует механизм внимания
   - Для каждой секунды не учитываются окружающие кадры в том формате, в котором учитывается звук.
6. Перспективы совершенствования
   - Использование трансформерной архитектуры вместо LSTM. Стоит учесть, что в этом случае вычислительная сложность заметно возрастёт.
   - Доработка свёрточных нейронных сетей для формирования первичных эмбеддингов
   - Учёт для каждой секунды окружающих кадров. В этом случае возможен рост вычислительной сложности
   - Доработка способа учёта окружающих кадров и звука. В частности, возможный отказ от добавления искусственного звука и кадров в начале фильма.
   - Оптимизация алгоритма кластеризации. Как вариант, можно использовать алгоритм на основе HDBSCAN, если по результатам эксперментов это можно будет считать целесообразным.
